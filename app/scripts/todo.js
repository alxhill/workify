// Generated by CoffeeScript 1.6.3
angular.module('workify').controller('TodoCtrl', function($scope) {
  chrome.storage.local.get('todolist', function(value) {
    return $scope.$apply(function() {
      return $scope.load(value);
    });
  });
  $scope.save = function() {
    return chrome.storage.local.set({
      todolist: $scope.todos
    });
  };
  $scope.load = function(value) {
    if (value && value.todolist) {
      return $scope.todos = value.todolist;
    } else {
      $scope.todos = [];
      $scope.addTodo("Build Workify");
      $scope.addTodo("Make workify save to chrome localstorage");
      $scope.addTodo("Make workify block pages");
      $scope.addTodo("Pass exams");
      $scope.addTodo("Learn WebGL");
      return $scope.save();
    }
  };
  $scope.nextid = 0;
  $scope.addTodo = function(title) {
    if (title != null) {
      if (angular.isArray(title)) {
        $scope.todos.concat(_.map(function(el) {
          return _.extend(el, {
            done: false,
            id: $scope.nextid++
          });
        }));
      } else {
        $scope.todos.push({
          title: title,
          done: false,
          id: $scope.nextid++
        });
      }
      $scope.todoInput = "";
      return $scope.save();
    }
  };
});
